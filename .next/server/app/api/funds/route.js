"use strict";(()=>{var e={};e.id=615,e.ids=[615],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1396:e=>{e.exports=require("undici")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},9601:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>h,requestAsyncStorage:()=>p,routeModule:()=>u,serverHooks:()=>f,staticGenerationAsyncStorage:()=>d});var a={};t.r(a),t.d(a,{GET:()=>c});var o=t(9303),n=t(8716),s=t(670),i=t(7070),l=t(1330);async function c(){try{let e=await (0,l.c)();return i.NextResponse.json({funds:e})}catch(e){return console.error("Error in /api/funds:",e),i.NextResponse.json({error:"Failed to fetch funds"},{status:500})}}let u=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/funds/route",pathname:"/api/funds",filename:"route",bundlePath:"app/api/funds/route"},resolvedPagePath:"/Users/yashakula/Documents/Projects/mf-analysis-tools/app/api/funds/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:p,staticGenerationAsyncStorage:d,serverHooks:f}=u,m="/api/funds/route";function h(){return(0,s.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:d})}},1330:(e,r,t)=>{t.d(r,{c:()=>u,E:()=>p});var a=t(9909);let o=require("fs");var n=t.n(o),s=t(1017),i=t.n(s),l=t(1915);async function c(e){let r=process.env.BLOB_READ_WRITE_TOKEN;if(r)try{let{blobs:t}=await (0,a.pb)({prefix:`data/${e}`,token:r});if(t&&t.length>0){let e=t[0].url,r=await fetch(e);if(r.ok){let e=await r.text();return(0,l.Q)(e,{columns:!0,skip_empty_lines:!0})}}}catch(r){console.error(`Blob loading error for ${e}:`,r)}try{let r=i().join(process.cwd(),"data"),t=i().join(r,e),a=n().readFileSync(t,"utf-8");return(0,l.Q)(a,{columns:!0,skip_empty_lines:!0})}catch(r){return console.error(`Local file loading error for ${e}:`,r),[]}}async function u(){let e=process.env.BLOB_READ_WRITE_TOKEN;if(e)try{let{blobs:r}=await (0,a.pb)({prefix:"data/",token:e}),t=[];for(let e of r){let r=e.pathname;if(r.startsWith("data/")&&r.endsWith(".csv")){let e=r.replace("data/","").replace(".csv","");t.push({id:e,name:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())})}}return t}catch(e){console.error("Error listing funds from blob:",e)}try{let e=i().join(process.cwd(),"data");return n().readdirSync(e).filter(e=>e.endsWith(".csv")).map(e=>({id:e.replace(".csv",""),name:e.replace(".csv","").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}))}catch(e){return console.error("Error listing local files:",e),[]}}async function p(e){let r=`${e}.csv`;return function(e,r){if(!e||0===e.length)return{fund_name:r,holdings:[],total_stocks:0};let t=Object.keys(e[0]),a=t.includes("Company Name")?"Company Name":"Holding Name",o=t.includes("% Portfolio Weight")?"% Portfolio Weight":"% Portfolio",n=[];for(let r of e)try{let e=r[a]?.trim(),t=r[o];if(!e||!(t=String(t).replace("%","").trim()))continue;let s=parseFloat(t);n.push({name:e,weight:Math.round(100*s)/100})}catch(e){continue}return n.sort((e,r)=>e.name.localeCompare(r.name)),{fund_name:r,holdings:n,total_stocks:n.length}}(await c(r),e)}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[948,717],()=>t(9601));module.exports=a})();